#!/usr/bin/env node
'use strict';

const mri = require('mri');
const make = require('./chunks/make.cjs');
require('globby');
require('pathe');
require('fs-extra');
require('esbuild');
require('jiti');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e["default"] : e; }

const mri__default = /*#__PURE__*/_interopDefaultLegacy(mri);

async function main() {
  const args = mri__default(process.argv.splice(2));
  if (args.help) {
    console.log("Usage: npx mkdist [rootDir] [--src=src] [--dist=dist] [--pattern=glob] [--format=cjs|esm] [-d|--declaration] [--ext=mjs|js|ts]");
    process.exit(0);
  }
  const { writtenFiles } = await make.mkdist({
    rootDir: args._[0],
    srcDir: args.src,
    distDir: args.dist,
    format: args.format,
    pattern: args.pattern,
    ext: args.ext,
    declaration: Boolean(args.declaration || args.d)
  });
  console.log(writtenFiles.map((f) => `- ${f}`).join("\n"));
  process.exit(0);
}
main().catch((err) => {
  console.error(err);
  process.exit(1);
});
